<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ILOVEYOU VENUS - Games</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { font-family: 'Quicksand', sans-serif; background-color: #fdf2f8; overflow-x: hidden; }
        .font-handwriting { font-family: 'Dancing Script', cursive; }
        .font-serif-display { font-family: 'Playfair Display', serif; }
        @keyframes fall {
            0% { transform: translateY(-10vh) translateX(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(110vh) translateX(20px) rotate(360deg); opacity: 0; }
        }
        .heart-particle { position: fixed; top: -10%; pointer-events: none; animation-name: fall; animation-timing-function: linear; animation-iteration-count: infinite; }
        .glass-panel { background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.5); }
        
        .option-btn:active { transform: scale(0.98); }
        .correct-anim { animation: pulse-green 0.5s ease-in-out; background-color: #86efac !important; border-color: #22c55e !important; }
        .wrong-anim { animation: shake-red 0.5s ease-in-out; background-color: #fca5a5 !important; border-color: #ef4444 !important; }

        @keyframes pulse-green {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes shake-red {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
    </style>
</head>
<body class="bg-pink-50 text-gray-900 pb-8 md:pb-0">

    <div id="hearts-container" class="fixed inset-0 pointer-events-none z-0"></div>
    <div class="hidden md:block absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-rose-300 via-pink-500 to-rose-300"></div>

    <main class="relative z-10 pt-6 md:pt-10 min-h-screen flex flex-col items-center">
        <!-- Back Button -->
        <div class="w-full max-w-2xl px-4 mb-4 flex">
            <a href="home.html" class="inline-flex items-center gap-2 px-4 py-2 rounded-full glass-panel shadow-md text-sm text-rose-700 hover:bg-rose-100 transition-all">
                <i data-lucide="arrow-left" width="18"></i>
                <span>Back to Home</span>
            </a>
        </div>

        <div class="w-full max-w-2xl px-4 animate-[slideUp_0.5s_ease-out]">
            <h2 class="text-3xl font-serif-display text-center text-rose-800 mb-2">Love Quiz</h2>
            <p class="text-center text-gray-500 mb-8 font-handwriting text-xl">How well do you know us?</p>

            <div id="quiz-card" class="glass-panel p-6 md:p-8 rounded-3xl shadow-xl relative min-h-[400px] flex flex-col justify-center">
                <!-- Question Section -->
                <div id="question-section" class="transition-opacity duration-300">
                    <div class="mb-2 text-rose-400 font-bold tracking-widest text-xs uppercase">Question <span id="q-number">1</span>/10</div>
                    <h3 id="q-text" class="text-2xl font-bold text-gray-800 mb-8 leading-relaxed">Question text goes here?</h3>
                    
                    <div id="options-container" class="space-y-3">
                        <!-- Options generated by JS -->
                    </div>
                </div>

                <!-- Result Section -->
                <div id="result-section" class="hidden text-center animate-[fadeIn_0.5s_ease]">
                    <div class="w-24 h-24 bg-rose-100 rounded-full flex items-center justify-center mx-auto mb-6 text-rose-500 shadow-inner">
                        <i data-lucide="trophy" width="48" height="48"></i>
                    </div>
                    <h3 class="text-3xl font-serif-display font-bold text-gray-800 mb-2">Quiz Completed!</h3>
                    <p class="text-gray-600 mb-6">You scored <span id="score-display" class="font-bold text-rose-600 text-2xl">0</span>/10</p>
                    
                    <div class="p-6 bg-white/50 rounded-2xl border border-rose-100 mb-8 transform hover:scale-105 transition-transform duration-300">
                        <p class="font-handwriting text-4xl text-rose-600 animate-pulse">I LOVE YOU! ❤️</p>
                    </div>

                    <button onclick="location.reload()" class="px-8 py-3 bg-rose-500 text-white rounded-full font-bold shadow-lg hover:bg-rose-600 transition-all hover:shadow-rose-200/50">
                        Play Again
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal (after Question 10) -->
    <div id="love-modal" class="fixed inset-0 z-50 hidden items-center justify-center bg-black/40 p-4">
        <div class="glass-panel rounded-3xl shadow-2xl p-8 w-full max-w-md text-center border border-white/60">
            <p class="font-handwriting text-4xl text-rose-600 mb-4 animate-pulse">I LOVE YOU TOO LOVE ❤️</p>
            <button id="love-modal-ok" class="px-8 py-3 bg-rose-500 text-white rounded-full font-bold shadow-lg hover:bg-rose-600 transition-all hover:shadow-rose-200/50">
                OK
            </button>
        </div>
    </div>

    <script>
        if(localStorage.getItem('venus_auth') !== 'true') window.location.href = 'landingpage.html';
        lucide.createIcons();

        // Hearts Background
        const heartsContainer = document.getElementById('hearts-container');
        function createHeart() {
            const heart = document.createElement('div');
            heart.className = 'heart-particle absolute text-pink-300 opacity-60';
            heart.innerText = '❤';
            heart.style.left = Math.random() * 100 + '%';
            heart.style.fontSize = (Math.random() * 20 + 10) + 'px';
            heart.style.animationDuration = (Math.random() * 5 + 5) + 's';
            heartsContainer.appendChild(heart);
            setTimeout(() => heart.remove(), 10000);
        }
        setInterval(createHeart, 300);

        const questions = [
            {
                question: "When is our 1st anniversary date?",
                options: [
                    "A. December 13, 2025",
                    "B. December 13, 2024",
                    "C. January 1, 2025",
                    "D. December 25, 2024"
                ],
                correct: 0
            },
            {
                question: "What was my first gift to you?",
                options: [
                    "A. Flowers",
                    "B. Hair claw",
                    "C. Chocolate",
                    "D. Letter"
                ],
                correct: 1
            },
            {
                question: "What is my favorite gift from you?",
                options: [
                    "A. Perfume",
                    "B. T-shirt with name tinatangi",
                    "C. Nike Dunk shoes",
                    "D. Necklace"
                ],
                correct: 2
            },
            {
                question: "Where was our first date?",
                options: [
                    "A. Boarding house of Moises",
                    "B. Boarding house of Charlotte",
                    "C. Park",
                    "D. Restaurant"
                ],
                correct: 0
            },
            {
                question: "What is my favorite color?",
                options: [
                    "A. Pink",
                    "B. Blue",
                    "C. Cyan",
                    "D. Red"
                ],
                correct: 2
            },

            // ✅ Q6 (PHOTO ONLY)
            {
                question: "What is my favorite photo of you?",
                photoOnly: true,
                options: [
                    { img: "495267194_1235612428052752_4018956227771002623_n.jpg" },
                    { img: "515650601_2564649913886981_1834618709276440267_n (1).jpg" },
                    { img: "521907056_609287725217407_5033584361373743026_n.jpg" },
                    { img: "595206140_820150637519557_8290638359988392569_n.jpg" }
                ],
                correct: 1
            },

            // ✅ Q7 (PHOTO ONLY)
            {
                question: "What is my favorite photo of us?",
                photoOnly: true,
                options: [
                    { img: "475184999_1161444455384023_7877809039935528353_n.jpg" },
                    { img: "462555844_581365088141786_6931526350879744522_n (1).jpg" },
                    { img: "485856874_638039375687500_9049021417729417729_n.jpg" },
                    { img: "508772510_1977896922614230_1109792504537314854_n.jpg" }
                ],
                correct: 1
            },

            {
                question: "What is my favorite part of your body?",
                options: [
                    "A. Eyes",
                    "B. Hair",
                    "C. Smile",
                    "D. Hands"
                ],
                correct: 1
            },
            {
                question: "Favorite music of us",
                options: [
                    "A. Palagi by TJ Monterde",
                    "B. Pasilyo by Sunkissed Lola",
                    "C. Perfect by Ed Sheeran",
                    "D. Ikaw by Yeng Constantino"
                ],
                correct: 0
            },

            // ✅ Q10 (ALL ANSWERS CORRECT)
            {
                question: "Do you love me?",
                options: [
                    "A. yes",
                    "B. Letter A",
                    "C. both A and B",
                    "D. All of the above"
                ],
                correctAll: true
            }
        ];

        let currentQuestion = 0;
        let score = 0;
        let canClick = true;

        function getOptionText(opt) {
            const raw = (typeof opt === "string") ? opt : (opt && opt.text ? opt.text : "");
            if (/^[A-D]\.\s/.test(raw)) return raw.substring(3);
            return raw;
        }

        function loadQuestion() {
            canClick = true;
            const q = questions[currentQuestion];
            document.getElementById('q-number').innerText = currentQuestion + 1;
            document.getElementById('q-text').innerText = q.question;
            
            const optsContainer = document.getElementById('options-container');
            optsContainer.innerHTML = '';

            const isPhotoOnly = q.photoOnly === true;

            q.options.forEach((opt, index) => {
                const btn = document.createElement('button');
                btn.className = "option-btn w-full p-4 rounded-xl border border-rose-100 bg-white/50 text-left hover:bg-rose-50 transition-all font-medium text-gray-700 flex items-center group";

                const letter = String.fromCharCode(65 + index);

                const hasImg = (typeof opt === "object") && opt && opt.img;
                const safeImg = hasImg ? encodeURI(opt.img) : "";

                if (isPhotoOnly && hasImg) {
                    // ✅ PHOTO ONLY + BIGGER IMAGE
                    btn.innerHTML = `
                        <div class="w-8 h-8 rounded-full bg-rose-100 text-rose-600 flex items-center justify-center mr-3 text-sm font-bold group-hover:bg-rose-200 transition-colors">
                            ${letter}
                        </div>
                        <img src="${safeImg}" alt="${letter}" class="w-28 h-28 md:w-32 md:h-32 rounded-2xl object-cover shadow-lg border border-white/60"
                             onerror="this.style.display='none'">
                    `;
                } else {
                    const text = getOptionText(opt);
                    btn.innerHTML = `
                        <div class="w-8 h-8 rounded-full bg-rose-100 text-rose-600 flex items-center justify-center mr-3 text-sm font-bold group-hover:bg-rose-200 transition-colors">
                            ${letter}
                        </div>
                        ${hasImg ? `
                          <img src="${safeImg}" alt="${text}" class="w-14 h-14 rounded-xl object-cover shadow mr-3 border border-white/60"
                               onerror="this.style.display='none'">
                        ` : ``}
                        <div class="flex-1 break-words">${text}</div>
                    `;
                }
                
                btn.onclick = () => handleAnswer(index, btn);
                optsContainer.appendChild(btn);
            });
        }

        function openLoveModal() {
            const modal = document.getElementById('love-modal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        function closeLoveModal() {
            const modal = document.getElementById('love-modal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }

        document.getElementById('love-modal-ok').addEventListener('click', () => {
            closeLoveModal();
            showResult();
        });

        document.getElementById('love-modal').addEventListener('click', (e) => {
            if (e.target.id === 'love-modal') {
                closeLoveModal();
                showResult();
            }
        });

        function handleAnswer(selectedIndex, btnElement) {
            if(!canClick) return;
            canClick = false;

            const q = questions[currentQuestion];
            const isLastQuestion = currentQuestion === questions.length - 1;

            const correctIndex = (q.correctAll === true) ? selectedIndex : q.correct;

            if(selectedIndex === correctIndex) {
                score++;
                btnElement.classList.add('correct-anim');
            } else {
                btnElement.classList.add('wrong-anim');
                const buttons = document.querySelectorAll('.option-btn');
                buttons[correctIndex].classList.add('correct-anim');
            }

            setTimeout(() => {
                if(!isLastQuestion) {
                    currentQuestion++;
                    loadQuestion();
                } else {
                    openLoveModal();
                }
            }, 1000);
        }

        function showResult() {
            document.getElementById('question-section').classList.add('hidden');
            document.getElementById('result-section').classList.remove('hidden');
            document.getElementById('score-display').innerText = score;
            
            for(let i=0; i<50; i++) {
                setTimeout(createHeart, i * 50);
            }
        }

        loadQuestion();
    </script>

    <!-- Background music resume script -->
    <script>
      // Resume background music across pages using saved state from music.html
      (function() {
        const raw = localStorage.getItem('venus_player_state');
        if (!raw) return;

        let state;
        try {
          state = JSON.parse(raw);
        } catch (e) {
          return;
        }
        if (!state || !state.src) return;

        const bgAudio = new Audio();
        bgAudio.preload = 'metadata';
        bgAudio.src = state.src;
        bgAudio.currentTime = state.currentTime || 0;

        if (state.isPlaying) {
          bgAudio.play().catch(() => {
            // Autoplay may be blocked until user interacts
          });
        }

        function save() {
          const newState = {
            src: state.src,
            index: state.index,
            currentTime: bgAudio.currentTime || 0,
            isPlaying: !bgAudio.paused
          };
          localStorage.setItem('venus_player_state', JSON.stringify(newState));
        }

        bgAudio.addEventListener('timeupdate', save);
        window.addEventListener('beforeunload', save);
      })();
    </script>
</body>
</html>


